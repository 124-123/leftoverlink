{% extends 'navbar.html'%}
{% load static %}
{% block content %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="{% static 'css/responsive.css' %}" />
    <title>Donor Dashboard | LeftoverLink</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />

    <style>
        body {
            background-color: #f5f6fa;
            font-family: 'Segoe UI', sans-serif;
        }

        /* Animations */
        .fade-slide {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeSlideIn 0.6s ease forwards;
        }

        @keyframes fadeSlideIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Sidebar styles */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 70px;
            background-color: white;
            border-right: 1px solid #ddd;
            padding-top: 2rem;
            transition: width 0.3s ease;
            overflow-x: hidden;
            z-index: 1000;
        }

        .sidebar:hover {
            width: 250px;
        }

        .sidebar h4 {
            padding-left: 1rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            white-space: nowrap;
        }

        .sidebar:hover h4 {
            opacity: 1;
        }

        .sidebar .nav-link {
            color: #333;
            padding: 12px 20px;
            font-weight: 500;
            display: flex;
            align-items: center;
            white-space: nowrap;
            transition: background-color 0.2s ease;
        }

        .sidebar .nav-link i {
            font-size: 1.2rem;
            margin-right: 16px;
            min-width: 24px;
            text-align: center;
            transition: transform 0.3s;
        }

        .sidebar .nav-link:hover i {
            transform: scale(1.2);
        }

        .sidebar .nav-link:hover {
            background-color: #f1f3f5;
            border-radius: 8px;
        }

        .sidebar .nav-link.active {
            background-color: #e6f4ea;
            color: #1c7d4f;
            border-radius: 10px;
        }

        .sidebar button {
            margin: 0 auto;
            display: block;
            width: 90%;
        }

        .sidebar .nav-link span {
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .sidebar:hover .nav-link span {
            opacity: 1;
        }

        .main-content {
            margin-left: 70px;
            transition: margin-left 0.3s ease;
            padding: 2rem;
        }

        .sidebar:hover~.main-content {
            margin-left: 220px;
        }

        .dashboard-header {
            margin-bottom: 30px;
        }

        .listing-card {
            border: none;
            border-radius: 12px;
            padding: 1rem 1.2rem;
            margin-bottom: 1rem;
            background: linear-gradient(to bottom right, #ffffff, #f1f3f5);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.06);
            transition: transform 0.3s ease;
        }

        .listing-card:hover {
            transform: translateY(-5px);
        }

        .donation-table {
            border-radius: 12px;
            overflow: hidden;
            background: #ffffff;
            box-shadow: 0 4px 18px rgba(0, 0, 0, 0.05);
        }

        .donation-table td,
        .donation-table th {
            vertical-align: middle;
        }

        .btn-green {
            background-color: #1c7d4f;
            color: white;
            border-radius: 8px;
            text-align: center;
            padding: 10px;
            text-decoration: none;
            transition: background-color 0.3s ease;
        }

        .btn-green:hover {
            background-color: #145f3d;
            color: white;
        }

        .status-completed {
            background-color: #e6f4ea;
            color: #1c7d4f;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            text-align: center;
            display: inline-block;
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }

            .sidebar:hover {
                width: 100%;
            }

            .main-content {
                margin-left: 0;
            }

            .sidebar:hover~.main-content {
                margin-left: 0;
            }
        }
    </style>
</head>

<body>

    <div class="container-fluid">
        <div class="row">

            <!-- Sidebar -->
            <div class="sidebar d-flex flex-column">
                <h4 class="fw-bold"></h4>
                <nav class="nav flex-column mt-3">
                    <a class="nav-link active" href="#"><i class="bi bi-house-door-fill"></i><span>Dashboard</span></a>
                    <a class="nav-link" href="{% url 'food_list' %}"><i class="bi bi-card-list"></i><span>Active
                            Listings</span></a>
                    <a class="nav-link" href="{% url 'profile' %}"><i
                            class="bi bi-person-circle"></i><span>Profile</span></a>
                    <a class="nav-link" href="{% url 'settings' %}"><i
                            class="bi bi-gear-fill"></i><span>Settings</span></a>
                    <a class="nav-link" href="{% url 'realtimedash' %}"><i
                            class="bi bi-speedometer2"></i><span>Real-time Dashboard</span></a><br><br>
                </nav>
                <a class="nav-link active" href="{% url 'food_post' %}" class="btn btn-green mt-4"><i
                        class="bi bi-check-circle-fill"></i><span>Post New Item</span></a>
            </div>

            <!-- Main Content -->
            <div class="main-content col-md-10 offset-md-2">
                <div class="dashboard-header fade-slide">
                    <h2 class="fw-bold">Donor Dashboard</h2>
                    <p class="text-muted">Manage your donations and track your impact.</p>
                </div>

                <!-- Active Listings -->
                <div class="fade-slide" style="animation-delay: 0.2s;">
                    <h5 class="mb-3 fw-semibold">Active Listings</h5>
                    {% if active_listings %}
                    {% for post in active_listings %}
                    <div class="listing-card">
                        <h6>{{ post.food_title }}</h6>
                        <p>Quantity: {{ post.quantity }}</p>
                        <p>Expires: {% if post.expiry %}{{ post.expiry|date:"D, d M Y" }}{% else %}No expiry{% endif %}
                        </p>
                        <p>Status: {{ post.get_status_display }}</p>
                    </div>
                    {% endfor %}
                    {% else %}
                    <div class="listing-card">No active listings to show.</div>
                    {% endif %}
                </div>

                <!-- Donation History -->
                <div class="fade-slide" style="animation-delay: 0.4s;">
                    <h5 class="mt-5 mb-3 fw-semibold">Donation History</h5>
                    <table class="table donation-table">
                        <thead class="table-light">
                            <tr>
                                <th>Item</th>
                                <th>Date Donated</th>
                                <th>Recipient</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if donation_history %}
                            {% for donation in donation_history %}
                            <tr>
                                <td>{{ donation.food_post.food_title }}</td>
                                <td>{{ donation.date_donated|date:"D, d M Y" }}</td>
                                <td>{{ donation.recipient_name }}</td>
                                <td>
                                    {% if donation.status != 'completed' %}
                                    <a href="{% url 'mark_donation_completed' donation.id %}"
                                        class="btn btn-sm btn-success">Mark Completed</a>
                                    {% else %}
                                    <span class="status-completed">Completed</span>
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                            {% else %}
                            <tr>
                                <td colspan="4" class="text-center text-muted">No donation history yet.</td>
                            </tr>
                            {% endif %}
                        </tbody>

                    </table>
                </div>

            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    {% endblock %}
</body>

</html>